% Egy identifikacios eredmeny abrazolasa ido- es frekvenciatartomanyban.
% Az S vektor valos meres eredmenye, az egyutthatok debugger segitsegevel
% lettek kiolvasva a mikrokontroller memoriajabol.

clear all;
clc;
fs=16000;
NFFT=8192;
S=[0.000129615713, 0.000135472394, 0.000107435146, 8.87547649e-005, -3.52942443e-005, 3.00399461e-005, 0.000196197172, 0.000375433447, 0.000250521756,...
 0.000285307266, 0.000230521313, 5.15865504e-005, -0.000131161258, -1.30736189e-005, 0.000199053538, 0.000191537838, 0.000231484097, 0.000381268008,...
 0.000215749504, 4.73965229e-005, 7.52535971e-006, -0.000122586614, -6.65039697e-005, -0.000110467037, 7.03350233e-005, -6.40427697e-006, 2.45090705e-005,...
 6.96453499e-005, 0.000187971367, 9.11314564e-005, -0.000425943203, -0.00460020034, -0.0177925471, -0.0316475891, -0.0180235822, 0.0107259024, 0.0162028577,...
 0.0230325535, 0.027549345, 0.0137946801, 0.00896451809, -0.00147430494, -0.00118569809, -0.0046018376, -0.0020906853, 0.00777103053, 0.00339553878,...
 0.00809241924, 0.00450340705, 0.0114382738, -0.00504300045, -0.00310104038, -0.00760380272, -0.00657971855, -0.00366904843, -0.00487845903, 6.91769164e-005,...
 -0.00511862943, -0.00127253926, -0.00653933967, -0.00358823407, -0.0083577428, -0.00180296518, -0.00310901459, 0.00216769497, -0.00337568135, -0.00220571575,...
 -0.00582506554, -0.00310557871, -0.00748935807, -0.00349247549, -0.0041230591, -0.00077020732, -0.0019199535, 0.000589023693, -0.000983317266, 0.000975136645,...
 -0.00161141076, 0.000236547567, 0.000604682951, 0.000358912366, 0.000803400937, 0.000695862109, -0.00102879293, -0.00194375683, -0.00252315798, 0.000395963725,...
 0.00558151351, 0.00661253231, 0.00750573119, 0.00416852674, 0.00110515277, 0.000578375941, -0.00137670047, 0.000927701825, 0.00413291156, 0.00474978751,...
 0.00858909264, 0.00249199732, 0.00649406156, 0.00210806448, 0.000604277244, 0.00353805372, -0.00141107792, 0.00311272452, 0.00367296813, 0.00374007248,...
 0.00302961096, -0.00124023994, -0.0013051118, -0.000401326572, -0.00108726544, -0.00124996714, 0.0021734382, 0.000661682629, 0.000900333107, -0.00110947376,...
 -0.00170941418, 3.04584119e-005, -0.00300095743, -0.0021512073, -0.000202648996, -0.00117921364, 0.000412150781, -0.000932963623, -0.0011200119, -0.00176806038,...
 -0.00241335365, -0.00232474599, -0.00160049344, 0.000386855361, 0.000626646273, -0.000124863742, -0.00129037735, -0.00260682101, -0.00167863583, -0.00231462321,...
 -0.00193815352, -0.00205083587, -0.000958253222];
N=length(S);
f=(0:NFFT-1)*fs/NFFT;
subplot(211);
plot(0:N-1,S);
title('A masodlagos ut impulzusvalasza');
xlabel('n');
ylabel('s(n)');
subplot(212);
plot(f,20*log10(abs(fft(S,NFFT)/NFFT)));
xlim([0 fs/2]);
title('A masodlagos ut amplitudokarakterisztikaja');
xlabel('f [Hz]');
ylabel('|S(f)| [dB]');
