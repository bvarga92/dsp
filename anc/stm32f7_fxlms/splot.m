% Identifikacios eredmenyek abrazolasa ido- es frekvenciatartomanyban.
% Az S vektorok valos meresek eredmenyei, az egyutthatok debugger segitsegevel
% lettek kiolvasva a mikrokontroller memoriajabol.

clear all;
clc;

S16=[0.000129615713, 0.000135472394, 0.000107435146, 8.87547649e-005, -3.52942443e-005, 3.00399461e-005, 0.000196197172, 0.000375433447, 0.000250521756,...
 0.000285307266, 0.000230521313, 5.15865504e-005, -0.000131161258, -1.30736189e-005, 0.000199053538, 0.000191537838, 0.000231484097, 0.000381268008,...
 0.000215749504, 4.73965229e-005, 7.52535971e-006, -0.000122586614, -6.65039697e-005, -0.000110467037, 7.03350233e-005, -6.40427697e-006, 2.45090705e-005,...
 6.96453499e-005, 0.000187971367, 9.11314564e-005, -0.000425943203, -0.00460020034, -0.0177925471, -0.0316475891, -0.0180235822, 0.0107259024, 0.0162028577,...
 0.0230325535, 0.027549345, 0.0137946801, 0.00896451809, -0.00147430494, -0.00118569809, -0.0046018376, -0.0020906853, 0.00777103053, 0.00339553878,...
 0.00809241924, 0.00450340705, 0.0114382738, -0.00504300045, -0.00310104038, -0.00760380272, -0.00657971855, -0.00366904843, -0.00487845903, 6.91769164e-005,...
 -0.00511862943, -0.00127253926, -0.00653933967, -0.00358823407, -0.0083577428, -0.00180296518, -0.00310901459, 0.00216769497, -0.00337568135, -0.00220571575,...
 -0.00582506554, -0.00310557871, -0.00748935807, -0.00349247549, -0.0041230591, -0.00077020732, -0.0019199535, 0.000589023693, -0.000983317266, 0.000975136645,...
 -0.00161141076, 0.000236547567, 0.000604682951, 0.000358912366, 0.000803400937, 0.000695862109, -0.00102879293, -0.00194375683, -0.00252315798, 0.000395963725,...
 0.00558151351, 0.00661253231, 0.00750573119, 0.00416852674, 0.00110515277, 0.000578375941, -0.00137670047, 0.000927701825, 0.00413291156, 0.00474978751,...
 0.00858909264, 0.00249199732, 0.00649406156, 0.00210806448, 0.000604277244, 0.00353805372, -0.00141107792, 0.00311272452, 0.00367296813, 0.00374007248,...
 0.00302961096, -0.00124023994, -0.0013051118, -0.000401326572, -0.00108726544, -0.00124996714, 0.0021734382, 0.000661682629, 0.000900333107, -0.00110947376,...
 -0.00170941418, 3.04584119e-005, -0.00300095743, -0.0021512073, -0.000202648996, -0.00117921364, 0.000412150781, -0.000932963623, -0.0011200119, -0.00176806038,...
 -0.00241335365, -0.00232474599, -0.00160049344, 0.000386855361, 0.000626646273, -0.000124863742, -0.00129037735, -0.00260682101, -0.00167863583, -0.00231462321,...
 -0.00193815352, -0.00205083587, -0.000958253222];

S8=[0.000268430915, 0.000129716645, -2.52017689e-005, -0.000123778605, 9.96571398e-005, -0.000339385937, -0.000572025427, -0.000156742462, -9.31240575e-005,...
 -0.00014395146, -0.00011408257, -2.7357155e-005, -0.000126824511, -0.000248727534, 9.68626773e-005, 1.32600626e-005, -0.00015035666, -9.58368473e-005,...
 3.62589599e-005, -5.37061787e-005, 2.5242764e-006, 0.000128431711, 6.70885347e-005, -5.80312699e-005, -0.00126997021, -0.00895418599, -0.0247777887,...
 -0.022277927, 0.0223829672, 0.0449999571, 0.00829204079, -0.00387327652, 0.00912464969, 0.0143686067, 0.0132583482, -0.0111664515, -0.001492774,...
 0.00122848211, -0.00908789504, -0.00116892555, -0.00967600755, -0.00487262988, -0.00663683657, -0.008228519, -0.0104739284, -0.00521206809, -0.00554814888,...
 -0.00594178587, -0.0043253093, -0.00152323302, -0.000618270366, -0.00570740225, 0.000309140014, 0.000249986362, 0.00199984573, -0.00183460105, 0.00478903158,...
 0.00733519439, 0.00528631825, 0.00390540389, 0.00674934592, 0.00989201665, 0.00982013065, 0.0075167492, 0.00551990652, 0.00264598383, 0.0039616758,...
 0.00573121617, 0.00281002978, -0.000398658274, 0.000520463742, -0.000515593798, -0.00109842571, -0.00137895334, -0.00136203482, -0.00288991258,...
 -0.00765932864, -0.00691417139, -0.00444140518, -0.00375754479, -0.00700939726, -0.00766511355, -0.00498473598, -0.00323567656, -0.00118979241,...
 -0.00312815676, -0.00184710999, -0.0015873079, 0.00115192076, 0.00150796899, 0.000750131672, 0.000940265716, 0.001726722, 0.00334970793, 0.00298084295,...
 0.00246707164, 0.0036191917, 0.00259400718, 0.00317965401, 0.00296360091, 0.00290481257, 0.000604018802, 9.81370467e-005, 0.000530834426, 0.00111240475,...
 0.000566765317, -0.00160982087, -0.00118492846, -0.000630381692, 0.00101109187, 0.00120305817, -0.000428680709, -0.00293431687, -0.00141381612,...
 0.000359482714, -0.00176893512, -0.00240523973, -0.00151240232, 0.00110846269, -0.000978630036, -0.00214243913, -0.00119870738, -0.00131223106,...
 -0.000894046796, -0.000509843638, -0.000352564151, -0.000739472511, -0.000119604454, 0.000498685753, 0.00100944797, 0.000776403409, 0.00067828293,...
 0.00208058255, 0.0019859327, 0.00194410654, 0.000979110599, 0.00127155858, 0.0013641878, 0.00133474672, 0.00131207926, 0.00116184214, 0.000836771505,...
 0.000712357578, 0.000456665468, 0.000493968779, 0.000501845323, -7.44545832e-005, -0.000265337731, -0.000144969454, 0.000193755026, -0.000303112232,...
 -0.000568932213, -0.00101415219, -0.000909612107, -0.00132755237, -0.00155635993, -0.00278086495, -0.00137743622, -0.000859079999, -0.00173909427,...
 -0.00202212483, -0.00120676181, -0.00124873128, -0.00148638419, -0.00131703482, -0.0011140377, -0.000272921141, 0.000482977543, 0.00093182124, 0.00101863872,...
 0.00183940062, 0.00155480404, 0.00153530575, 0.00101331959, 0.00179555395, 0.00156999193, 0.000419359421, -5.38148015e-005, 0.000197870962, 0.000738207134,...
 -0.000219750771, -0.000938466983, -0.00049348583, -0.000215430948, 0.000604378991, 0.000711229979, 0.000386159634, 0.000146697465, 0.000206173703,...
 0.00144259888, 0.000406433915, -0.000889362709, 0.000151914341, 0.000170665371, 0.000447341241, 0.000121764126, -0.000485501194, 0.000581833825,...
 -0.000537288608, -1.67766757e-006, -0.000387135573, -0.00100678205, -0.00161592255, -0.00169320311, -0.000682534766, -0.000457362825, -0.00109265395,...
 -0.00138245907, 0.000533354294, 0.00135006139, 0.000938861398, 0.000404605991, 0.00155787356, 0.00113430026, 0.000992716639, 0.000110678891, 0.000146644641,...
 0.000556157494, 0.000131720983, 9.7203796e-005, 0.00136811857, 0.0013031672, 0.000171858002, -0.000406114035, -0.000752501481, -0.000479015813,...
 -0.000650307513, -0.000909978233, -0.000860942295, -0.00103654468, -0.00147939427, -0.0010443799, -0.000403605314, -0.000380115322, -0.000592138094,...
 -0.00102566613, -0.000772822881, 0.000159877731, 0.000338079029, 0.000197762303, 0.000287129689, 0.000272384903, 0.000400031451, 0.000327729213,...
 -0.000266229821, -0.00040241328, -0.000114282164, 0.000548541604, 0.00110552495, 0.00108183327];

NFFT=8192;
N=length(S16);
subplot(221);
plot(0:N-1,S16);
xlim([0 N-1]);
title(sprintf('Impulzusvalasz (16 kHz, N=%d)',N));
xlabel('n');
ylabel('s(n)');
subplot(223);
plot((0:NFFT-1)*16000/NFFT,20*log10(abs(fft(S16,NFFT)/NFFT)));
xlim([0 8000]);
title(sprintf('Amplitudokarakterisztika (16 kHz, N=%d)',N));
xlabel('f [Hz]');
ylabel('|S(f)| [dB]');
N=length(S8);
subplot(222);
plot(0:N-1,S8);
xlim([0 N-1]);
title(sprintf('Impulzusvalasz (8 kHz, N=%d)',N));
xlabel('n');
ylabel('s(n)');
subplot(224);
plot((0:NFFT-1)*8000/NFFT,20*log10(abs(fft(S8,NFFT)/NFFT)));
xlim([0 4000]);
title(sprintf('Amplitudokarakterisztika (8 kHz, N=%d)',N));
xlabel('f [Hz]');
ylabel('|S(f)| [dB]');
